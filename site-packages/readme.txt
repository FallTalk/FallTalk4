These are all the custom code changes I had to make to get this thing working on windows.